var push_event,chat_event,pusher;push_event=function(e){var n;"undefined"==typeof pusher?(Pusher.log=function(e){window.console&&window.console.log&&window.console.log(e)},pusher=new Pusher("e7d1b74dd30352eddd81"),n=pusher.subscribe("user_"+e),n.bind("matching",function(e){$.get("/entry",{matching_from:e.matching_to,matching_to:e.matching_from},function(e){})}),n.bind("cancelled",function(){$.ajax({type:"POST",url:"/entries"})}),n.bind("starting",function(e){if("confirm"===e.event_type)$(".start-conversation").attr("data-method","post"),$(".start-conversation").data("method","post"),$(".start-conversation").removeAttr("data-remote"),$(".start-conversation").removeData("remote");else{alert("ajax start");var n="/conversations/"+e.room_id;$.ajax({type:"GET",url:n,data:{sender_id:e.recipient_id,recipient_id:e.sender_id,your_id:e.recipient_id},error:function(e){alert(e+" did happen, please retry")}})}})):console.log("pusher already exists")},chat_event=function(){if("undefined"==typeof pusher){var e=$(".chatboxoptions").data("userid");if(Pusher.log=function(e){window.console&&window.console.log&&window.console.log(e)},e){var n;pusher=new Pusher("e7d1b74dd30352eddd81"),n=pusher.subscribe("user_"+e),n.bind("chat_event",function(n){var t,o,r;t="/conversations/"+n.message.conversation_id+"/messages",o=n.message.user_id,r=$(".chatboxoptions").data("userid"),$.get(t,{message:n.message,your_id:e},function(e){})})}}},$(".conversations").ready(function(){chat_event()});